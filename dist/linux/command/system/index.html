<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link
      rel="stylesheet"
      href="/black-devops-guidebook/docs__linux__command__system.md.chunk.css"
    />
    <script>
      window.routerBase = "/black-devops-guidebook/";
    </script>
    <script>
      //! umi version: 3.5.41
    </script>
    <script>
      !(function () {
        var e =
            navigator.cookieEnabled && void 0 !== window.localStorage
              ? localStorage.getItem("dumi:prefers-color")
              : "auto",
          o = window.matchMedia("(prefers-color-scheme: dark)").matches,
          t = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === t[2] ? (o ? t[1] : t[0]) : t.indexOf(e) > -1 ? e : t[0]
        );
      })();
    </script>
    <title>系统管理 - DevOps Guidebook</title>
  
</head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/linux/command/system" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/devops-icon.png&#x27;)" href="/black-devops-guidebook//">DevOps Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a aria-current="page" class="active" href="/black-devops-guidebook//linux">Linux</a></span><span><a href="/black-devops-guidebook//server">服务器</a></span><span><a href="/black-devops-guidebook//deploy">部署</a></span><span><a href="/black-devops-guidebook//code">代码管理</a></span><span><a href="/black-devops-guidebook//devops">DevOps</a></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/yyt520/black-devops-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/devops-icon.png&#x27;)" href="/black-devops-guidebook//"></a><h1>DevOps Guidebook</h1><p>DevOps 完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a aria-current="page" class="active" href="/black-devops-guidebook//linux">Linux</a></li><li><a href="/black-devops-guidebook//server">服务器</a></li><li><a href="/black-devops-guidebook//deploy">部署</a></li><li><a href="/black-devops-guidebook//code">代码管理</a></li><li><a href="/black-devops-guidebook//devops">DevOps</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/yyt520/black-devops-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a target="_blank" rel="noopener noreferrer">Linux 系统</a><ul><li><a href="/black-devops-guidebook//linux"><span>基本概要</span></a></li><li><a href="/black-devops-guidebook//linux/common-directory"><span>常见目录</span></a></li><li><a href="/black-devops-guidebook//linux/process"><span>进程</span></a></li><li><a href="/black-devops-guidebook//linux/file-permission"><span>文件权限</span></a></li><li><a href="/black-devops-guidebook//linux/package"><span>软件包</span></a></li><li><a href="/black-devops-guidebook//linux/firewall"><span>防火墙</span></a></li></ul></li><li><a target="_blank" rel="noopener noreferrer">常用命令</a><ul><li><a href="/black-devops-guidebook//linux/command/environment-variable"><span>环境变量</span></a></li></ul></li><li><a target="_blank" rel="noopener noreferrer">命令分类</a><ul><li><a aria-current="page" class="active" href="/black-devops-guidebook//linux/command/system"><span>系统管理</span></a></li><li><a href="/black-devops-guidebook//linux/command/network"><span>网络管理</span></a></li><li><a href="/black-devops-guidebook//linux/command/file"><span>文件管理</span></a></li><li><a href="/black-devops-guidebook//linux/command/directory"><span>目录管理</span></a></li><li><a href="/black-devops-guidebook//linux/command/devices"><span>设备管理</span></a></li><li><a href="/black-devops-guidebook//linux/command/package"><span>软件包管理</span></a></li><li><a href="/black-devops-guidebook//linux/command/other"><span>其他命令</span></a></li><li><a href="/black-devops-guidebook//linux/command/combination"><span>命令组合</span></a></li><li><a href="/black-devops-guidebook//linux/command/collection"><span>命令大全</span></a></li></ul></li><li><a target="_blank" rel="noopener noreferrer">Shell 编程</a><ul><li><a href="/black-devops-guidebook//linux/shell"><span>概述</span></a></li><li><a href="/black-devops-guidebook//linux/shell/variable"><span>变量</span></a></li><li><a href="/black-devops-guidebook//linux/shell/type"><span>类型</span></a></li><li><a href="/black-devops-guidebook//linux/shell/command"><span>命令</span></a></li><li><a href="/black-devops-guidebook//linux/shell/structured-command"><span>结构化命令</span></a></li><li><a href="/black-devops-guidebook//linux/shell/function"><span>函数</span></a></li><li><a href="/black-devops-guidebook//linux/shell/sign"><span>特殊符号</span></a></li></ul></li><li><a href="/black-devops-guidebook//linux/shell">Shell 编程</a><ul><li><a href="/black-devops-guidebook//linux/shell/expression"><span>表达式</span></a></li><li><a href="/black-devops-guidebook//linux/shell/shell-control"><span>脚本控制</span></a></li><li><a href="/black-devops-guidebook//linux/shell/tools"><span>实用工具</span></a></li></ul></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="进程信息" data-depth="2"><a href="/black-devops-guidebook//linux/command/system#进程信息"><span>进程信息</span></a></li><li title="进程和作业" data-depth="2"><a href="/black-devops-guidebook//linux/command/system#进程和作业"><span>进程和作业</span></a></li><li title="systemctl" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#systemctl"><span>systemctl</span></a></li><li title="ps" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#ps"><span>ps</span></a></li><li title="pstree" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#pstree"><span>pstree</span></a></li><li title="at" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#at"><span>at</span></a></li><li title="nice" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#nice"><span>nice</span></a></li><li title="renice" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#renice"><span>renice</span></a></li><li title="kill" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#kill"><span>kill</span></a></li><li title="nohup" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#nohup"><span>nohup</span></a></li><li title="用户和工作组" data-depth="2"><a href="/black-devops-guidebook//linux/command/system#用户和工作组"><span>用户和工作组</span></a></li><li title="useradd" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#useradd"><span>useradd</span></a></li><li title="userdel" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#userdel"><span>userdel</span></a></li><li title="usermod" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#usermod"><span>usermod</span></a></li><li title="groupadd" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#groupadd"><span>groupadd</span></a></li><li title="groupdel" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#groupdel"><span>groupdel</span></a></li><li title="groupmode" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#groupmode"><span>groupmode</span></a></li><li title="passwd" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#passwd"><span>passwd</span></a></li><li title="su" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#su"><span>su</span></a></li><li title="sudo" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#sudo"><span>sudo</span></a></li><li title="id" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#id"><span>id</span></a></li><li title="mount" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#mount"><span>mount</span></a></li><li title="crontab" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#crontab"><span>crontab</span></a></li><li title="用户和用户组的配置文件" data-depth="3"><a href="/black-devops-guidebook//linux/command/system#用户和用户组的配置文件"><span>用户和用户组的配置文件</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="系统管理"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#系统管理"><span class="icon icon-link"></span></a>系统管理</h1><ul><li>系统安全<ul><li><code>sudo</code> 以其他身份来执行命令</li></ul></li><li>进程和作业<ul><li><code>systemctl</code> 系统服务管理器指令</li><li><code>service</code> 控制系统服务的实用工具</li><li><code>w</code> 显示目前登入系统的用户信息</li><li><code>watch</code> 周期性执行给定的指令</li><li><code>pidof</code> 查找指定名称的进程的进程 ID 号</li><li><a href="/black-devops-guidebook//linux/command/system#ps"><code>ps</code></a> 报告当前系统的进程状态</li><li><code>telint</code> 切换当前正在运行系统的运行等级</li><li><code>init</code> 所有 Linux 进程的父进程</li><li><code>at</code> 在指定时间执行一个任务</li><li><code>crontab</code> 提交和管理用户的需要周期性执行的任务</li><li><code>nohup</code> 将程序以忽略挂起信号的方式运行起来</li><li><code>nice</code> 指定的进程调度优先级启动其他程序</li><li><code>renice</code> 修改正在运行的进程的调度优先级</li><li><code>kill</code> 删除执行中的程序或工作</li><li><code>pkill</code> 可以按照进程名杀死进程</li><li><code>skill</code> 向选定的进程发送信号冻结进程</li><li><code>killall</code> 使用进程的名称来杀死一组进程</li></ul></li><li>用户和工作组<ul><li><code>useradd</code> 新建用户</li><li><code>userdel</code> 删除用户</li><li><code>passwod</code> 修改用户密码</li><li><code>usermod</code> 修改用户属性</li><li><code>chage</code> 修改用户属性</li><li><code>change</code> 修改账号和密码的有效期限</li><li><code>id</code> 显示用户的 ID 以及所属群组的 ID</li><li><code>su</code> 用于切换当前用户身份到其他用户身份</li><li><code>logname</code> 打印执行该命令的用户名</li></ul></li><li>系统关机和重启<ul><li><code>shutdown</code> 执行系统关机命令</li></ul></li></ul><h2 id="进程信息"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#进程信息"><span class="icon icon-link"></span></a>进程信息</h2><ul><li>PID：进程 ID，进程的唯一标识</li><li>USER：进程所有者的实际用户名</li><li>PR：进程的调度优先级</li><li>NI：进程的 nice 值（优先级）越小的值代表优先级越高</li><li>VIRT：进程使用的虚拟内存</li><li>RES：驻留内存大小。驻留内存是任务使用的非交换物理内存大小。</li><li>SHR：进程使用的共享内存。</li><li>S：进程的状态<ul><li>D = 不可中断的睡眠态</li><li>R = 运行态</li><li>S = 睡眠态</li><li>T = 被跟踪或已停止</li><li>Z = 僵尸态</li></ul></li><li>%CPU：自从上一次更新时到现在任务所使用的 CPU 时间百分比。</li><li>%MEM：进程使用的可用物理内存百分比。</li><li>TIME+：任务启动后到现在所使用的全部 CPU 时间，精确到百分之一秒。</li><li>COMMAND：运行进程所使用的命令。</li></ul><h2 id="进程和作业"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#进程和作业"><span class="icon icon-link"></span></a>进程和作业</h2><h3 id="systemctl"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#systemctl"><span class="icon icon-link"></span></a>systemctl</h3><p><code>systemctl</code> 命令是系统服务管理器指令。它实际上将 <code>service</code> 和 <code>chkconfig</code> 这两个命令组合到一起。</p><p>Unit 一共分成 12 种。</p><ul><li>Service unit：系统服务</li><li>Target unit：多个 Unit 构成的一个组</li><li>Device Unit：硬件设备</li><li>Mount Unit：文件系统的挂载点</li><li>Automount Unit：自动挂载点</li><li>Path Unit：文件或路径</li><li>Scope Unit：不是由 Systemd 启动的外部进程</li><li>Slice Unit：进程组</li><li>Snapshot Unit：Systemd 快照，可以切回某个快照</li><li>Socket Unit：进程间通信的 socket</li><li>Swap Unit：swap 文件</li><li>Timer Unit：定时器</li></ul><p><code>systemctl list-units</code> 命令可以查看当前系统的所有 Unit。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 列出正在运行的 Unit</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ systemctl list-status</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 列出所有 Uni，包括没有找到配置文件的或者启动失败的</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ systemctl list-units -all</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 列出所有没有运行的 Unit</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ systemctl list-units -all --state</span><span class="token operator">=</span><span class="token plain">inactive</span></div></pre></div><p>当然 CentOS 管理后台服务也有一些套路。service 命令就是。 systemctl 兼容了 service 命令，我们看一下怎么重启 mysql 服务。推荐用下面这个。</p><p><code>systemctl</code> 是 CentOS7 的服务管理工具中主要的工具，它融合之前 service 和 chkconfig 的功能于一体。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 启动服务</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ systemctl start nginx.service</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 关闭服务</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ systecmtl stop nginx.service</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 重启服务</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ systemctl restart nginx.service</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看服务当前状态</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ systemctl status postfix.service</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 开机时自动启动服务</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ systemctl </span><span class="token builtin class-name">enable</span><span class="token plain"> nginx.service</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 开机时自动禁用服务</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ systemctl disable nginx.service</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看服务是否开机启动</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ systemctl is-enabled nginx.service</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看已启动的服务列表</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ systemctl list-unit-files </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">grep</span><span class="token plain"> enabled</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看启动失败的服务列表</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">$ systemctl --failed</span></div></pre></div><p>对于普通的进程，就要使用 <code>kill</code> 命令进行更佳详细的控制了。<code>kill</code> 命令有很多信号，如果你在用 <code>kill -9</code>，你一定想要了解 <code>kill -15</code> 以及 <code>kill -3</code> 的区别和用途。</p><h3 id="ps"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#ps"><span class="icon icon-link"></span></a>ps</h3><p><code>ps</code> 命令用于报告当前系统的进程状态。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 查看进程信息</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ps</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">pid</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 找到 java 进程</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ps</span><span class="token plain"> -ef </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">grep</span><span class="token plain"> java</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ps</span><span class="token plain"> -elf</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment">#</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ps</span><span class="token plain"> -e </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">more</span></div></pre></div><ul><li>进程也是树形结构</li><li>进程和权限有着密不可分的关系</li></ul><p>列出目前所有正在内存当中的程序：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">ps</span><span class="token plain"> aux</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># Output</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># USER               PID  %CPU %MEM      VSZ    RSS   TT  STAT STARTED      TIME COMMAND</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># kenny             6155  21.3  1.7  7969944 284912   ??  S    二03下午 199:14.14 /Appl...OS/WeChat</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># kenny              559  20.4  0.8  4963740 138176   ??  S    二03下午  33:28.27 /Appl...S/iTerm2</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># _windowserver      187  18.0  0.6  7005748  95884   ??  Ss   二03下午 288:44.97 /Syst...Light.WindowServer -daemon</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># kenny             1408  10.7  2.1  5838592 347348   ??  S    二03下午 138:51.63 /Appl...nts/MacOS/Google Chrome</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># kenny              327   5.8  0.5  5771984  79452   ??  S    二03下午   2:51.58 /Syst...pp/Contents/MacOS/Finder</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 在所有程序中查找 nginx</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># -a 显示所有终端机下执行的程序</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># -u 列出该用户的程序的状况</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># -v 同 -a</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ps</span><span class="token plain"> aux </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">grep</span><span class="token plain"> nginx</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 列出类似程序树的程序显示</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ps</span><span class="token plain"> -axjf</span></div></pre></div><ul><li>USER：该 process 属于那个使用者账号的</li><li>PID ：该 process 的号码</li><li>%CPU：该 process 使用掉的 CPU 资源百分比</li><li>%MEM：该 process 所占用的物理内存百分比</li><li>VSZ ：该 process 使用掉的虚拟内存量 (Kbytes)</li><li>RSS ：该 process 占用的固定的内存量 (Kbytes)</li><li>TTY ：该 process 是在那个终端机上面运作，若与终端机无关，则显示 ?，另外， tty1-tty6 是本机上面的登入者程序，若为 pts/0 等等的，则表示为由网络连接进主机的程序。</li><li>STAT：该程序目前的状态，主要的状态有</li><li>R ：该程序目前正在运作，或者是可被运作</li><li>S ：该程序目前正在睡眠当中 (可说是 idle 状态)，但可被某些讯号 (signal) 唤醒。</li><li>T ：该程序目前正在侦测或者是停止了</li><li>Z ：该程序应该已经终止，但是其父程序却无法正常的终止他，造成 zombie (疆尸) 程序的状态</li><li>START：该 process 被触发启动的时间</li><li>TIME ：该 process 实际使用 CPU 运作的时间</li><li>COMMAND：该程序的实际指令</li></ul><h3 id="pstree"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#pstree"><span class="icon icon-link"></span></a>pstree</h3><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 以树状结构显示线程结构</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">pstree</span></div></pre></div><h3 id="at"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#at"><span class="icon icon-link"></span></a>at</h3><p>基本格式：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">at </span><span class="token punctuation">[</span><span class="token plain">-f filename</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token function">time</span></div></pre></div><p>时间格式：</p><ul><li>标准的消失和分钟格式，比如 10:15</li><li>AM/PM 指示符，比如 10:15 PM</li><li>特定可命名时间，比如 <code>now</code>、<code>noon</code>、<code>midnigh</code> 或者 <code>teatime</code>（4 PM）</li></ul><p>除了指定运行作业的时间，也可以通过不同功能的日期格式指定特定的日期。</p><ul><li>标准日期格式，比如 <code>MMDDYY</code>、<code>MM/DD/YY</code> 或 <code>DD.MM.YY</code></li><li>文本日期，比如 <code>Jul 4</code> 或 <code>Dec 25</code>，加不加年份均可</li><li>你也可以指定时间增量<ul><li>当前时间 <code>+25min</code></li><li>明天 <code>10:15 PM</code></li><li><code>10:15+7天</code></li></ul></li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># -f 指明执行的脚本文件，now 指明 at 命令立即执行该脚本</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">at -f timer.sh now</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 如果不想在 at 命令中使用邮件或重定向，最好加上 -M 选项来屏蔽作业产生的输出信息</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">at -M -f timer.sh tomorrow</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查询待执行作业列表</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">atq</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 删除作业</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 先通过 atq 查询待执行作业，删除作业号为 10 的作业</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">atrm </span><span class="token number">10</span></div></pre></div><h3 id="nice"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#nice"><span class="icon icon-link"></span></a>nice</h3><p><code>nice</code> 命令允许你设置命令启动时的调度优先级。要让命令以更低的优先级运行，只要用 <code>nice</code> 的 <code>-n</code> 命令来指定新的优先级级别。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># -n 选项并非必须的，只要在破折号后跟上优先级即可</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">nice</span><span class="token plain"> -n </span><span class="token number">10</span><span class="token plain"> ./test.sh </span><span class="token operator">&gt;</span><span class="token plain"> test.out </span><span class="token operator">&amp;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 新建进程并设置优先级，将当前目录下的 documents 目录打包，但不希望 tar 占用太多 CPU</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">nice</span><span class="token plain"> -10 </span><span class="token function">tar</span><span class="token plain"> zcf pack.tar.gz documents</span></div></pre></div><h3 id="renice"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#renice"><span class="icon icon-link"></span></a>renice</h3><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 对运行中的 PID 为 5055 的进程调整调度优先级</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">renice</span><span class="token plain"> -n </span><span class="token number">10</span><span class="token plain"> -p </span><span class="token number">5055</span></div></pre></div><p>限制：</p><ul><li>只能对属于你的进程执行 <code>renice</code></li><li>只能通过 <code>renice</code> 降低进程的优先级</li><li>root 用户可以通过 <code>renice</code> 来任意调整进程的优先级</li></ul><p>如果想完全控制运行进程，必须以 root 账户身份登录或使用 <code>sudo</code> 命令。</p><h3 id="kill"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#kill"><span class="icon icon-link"></span></a>kill</h3><p><code>kill</code> 命令用来删除执行中的程序或工作。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 列出所有信号名称</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">kill</span><span class="token plain"> -l</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 无条件结束 pid 为 22817 的进程</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">kill</span><span class="token plain"> -9 </span><span class="token number">22817</span></div></pre></div><p>可以先通过 <code>ps</code> 查找进程，然后用 <code>kill</code> 杀掉：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">$ </span><span class="token function">ps</span><span class="token plain"> -ef </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">grep</span><span class="token plain"> </span><span class="token function">vim</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">root      </span><span class="token number">3268</span><span class="token plain">  </span><span class="token number">2884</span><span class="token plain">  </span><span class="token number">0</span><span class="token plain"> </span><span class="token number">16</span><span class="token plain">:21 pts/1    00:00:00 </span><span class="token function">vim</span><span class="token plain"> install.log</span></div><div class="token-line"><span class="token plain">root      </span><span class="token number">3370</span><span class="token plain">  </span><span class="token number">2822</span><span class="token plain">  </span><span class="token number">0</span><span class="token plain"> </span><span class="token number">16</span><span class="token plain">:21 pts/0    00:00:00 </span><span class="token function">grep</span><span class="token plain"> </span><span class="token function">vim</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">$ </span><span class="token function">kill</span><span class="token plain"> </span><span class="token number">3268</span></div></pre></div><p>常用的信号：</p><ul><li><code>HUP</code>（1）：终端断线</li><li><code>INT</code>（2）：中断（同 Ctrl + C）</li><li><code>QUIT</code>（3）：退出（同 Ctrl + \）</li><li><code>TERM</code>(15)：终止</li><li><code>KILL</code>（9）：强制终止</li><li><code>CONT</code>（18）：继续（与 STOP 相反）</li><li><code>STOP</code>（19）：暂停（同 Ctrl + Z）</li></ul><h3 id="nohup"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#nohup"><span class="icon icon-link"></span></a>nohup</h3><p><code>nohup</code> 命令可以将程序以忽略挂起信号的方式运行起来，被运行的程序的输出信息将不会显示到终端。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 以忽略挂起信号运行 /var/log/message</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">nohup</span><span class="token plain"> </span><span class="token function">tail</span><span class="token plain"> -f /var/log/messages </span><span class="token operator">&amp;</span></div></pre></div><h2 id="用户和工作组"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#用户和工作组"><span class="icon icon-link"></span></a>用户和工作组</h2><p>只有 <code>root</code> 用户采用创建/删除/修改用户的权限。</p><h3 id="useradd"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#useradd"><span class="icon icon-link"></span></a>useradd</h3><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 创建用户，名为 user1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">useradd</span><span class="token plain"> user1</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 新建用户 user2 时，直接指定组 group1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">useradd</span><span class="token plain"> -g group1 user2</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 创建新用户，用户不允许登录（通过 ftp 可以连接）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">adduser ftpusername -s /sbin/nologin</span></div></pre></div><h3 id="userdel"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#userdel"><span class="icon icon-link"></span></a>userdel</h3><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 永久性删除用户账号 user1（保留用户数据）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">userdel</span><span class="token plain"> user1</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 彻底永久性删除用户账号 user2（及其 home 目录下的数据）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">userdel</span><span class="token plain"> -r user2</span></div></pre></div><h3 id="usermod"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#usermod"><span class="icon icon-link"></span></a>usermod</h3><p>修改用户账号的相对应信息。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 修改用户 home 目录地址（放到 ben1 目录下）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">usermode -d /home/ben1 user1</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 将 user1 的用户组改为 group1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">usermode -group1 user1</span></div></pre></div><h3 id="groupadd"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#groupadd"><span class="icon icon-link"></span></a>groupadd</h3><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 新建用户组</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">groupadd</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 新建用户组 group1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">groupadd</span><span class="token plain"> group1</span></div></pre></div><h3 id="groupdel"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#groupdel"><span class="icon icon-link"></span></a>groupdel</h3><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 永久性删除用户工作组 group1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">groupdel</span><span class="token plain"> group1</span></div></pre></div><h3 id="groupmode"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#groupmode"><span class="icon icon-link"></span></a>groupmode</h3><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 修改用户组</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">groupmod</span></div></pre></div><h3 id="passwd"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#passwd"><span class="icon icon-link"></span></a>passwd</h3><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 为用户 ben 设置密码</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">passwd</span><span class="token plain"> ben</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 为当前用户修改密码</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">passwd</span></div></pre></div><h3 id="su"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#su"><span class="icon icon-link"></span></a>su</h3><p>su 用来切换用户。比如你现在是 root，想要用 <code>ben</code> 用户做一些勾当，就可以使用 su 切换。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 切换到 ben 用户（使用 login shell 方式切换用户）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">su</span><span class="token plain"> - ben</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 不完全切换（不带减号）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">su</span><span class="token plain"> ben</span></div></pre></div><p>可以让你干净纯洁的降临另一个账号，不出意外，推荐。</p><h3 id="sudo"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#sudo"><span class="icon icon-link"></span></a>sudo</h3><p>sudo 以其他用户身份执行命令</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 设置需要使用 sudo 的用户（组）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">visudo</span></div></pre></div><h3 id="id"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#id"><span class="icon icon-link"></span></a>id</h3><p>查看用户信息及所属组别。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 查看名为 ben 的用户信息</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">id</span><span class="token plain"> ben</span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 显示当前进程用户所属用户组</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">grouos</span></div></pre></div><h3 id="mount"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#mount"><span class="icon icon-link"></span></a>mount</h3><p>mount 命令可以挂在一些外接设备，比如 u 盘，比如 iso，比如刚申请的 ssd。可以放心的看小电影了。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">mount</span><span class="token plain"> /dev/sdb1 /xiaodianying</span></div></pre></div><h3 id="crontab"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#crontab"><span class="icon icon-link"></span></a>crontab</h3><p>这就是 Linux 本地的 job 工具。不是分布式的，你要不是运维，就不要用了。比如，每 10 分钟提醒喝茶上厕所。</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">_/10 _ </span><span class="token punctuation">\</span><span class="token plain">* </span><span class="token punctuation">\</span><span class="token plain">* </span><span class="token punctuation">\</span><span class="token plain">* /home/xjj/wc10min</span></div></pre></div><h3 id="用户和用户组的配置文件"><a aria-hidden="true" tabindex="-1" href="/black-devops-guidebook//linux/command/system#用户和用户组的配置文件"><span class="icon icon-link"></span></a>用户和用户组的配置文件</h3><p>查看用户信息的一些命令：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 查看系统中所有用户</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">cut</span><span class="token plain"> -d </span><span class="token builtin class-name">:</span><span class="token plain"> -f </span><span class="token number">1</span><span class="token plain"> /etc/passwd</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看可以登录系统的用户</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">cat</span><span class="token plain"> /etc/passwd </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">grep</span><span class="token plain"> -v /sbin/nologin </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function">cut</span><span class="token plain"> -d </span><span class="token builtin class-name">:</span><span class="token plain"> -f </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看登录用户</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">who</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看某一用户</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">w mysql</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 查看用户登录历史记录</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">last</span></div></pre></div><p>查看用户配置文件：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 查看用户 user1 自己的 /home 目录（查看时要打开隐藏文件可见）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">ls</span><span class="token plain"> -a /home/user1</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 创建用户的信息也会记录在 /etc/passwd 文件中</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">tail</span><span class="token plain"> -10 /etc/passwd</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 创建用户也会在 /etc/shadow 保留用户信息</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">tail</span><span class="token plain"> -10 /etc/shadow</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 删除用户 user1 目录</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">rm</span><span class="token plain"> -rf /var/spool mail/user1</span></div><div class="token-line"><span class="token plain"></span><span class="token function">rm</span><span class="token plain"> -rf /home/user1</span></div></pre></div><p>修改用户配置文件：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># 编辑用户配置文件</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">vim</span><span class="token plain"> /etc/passwd</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># 编辑用户组配置文件</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">vim</span><span class="token plain"> /etc/group</span></div></pre></div></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/yyt520/black-devops-guidebook/edit/master/docs/linux/command/system.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last update: ">2023/7/9 18:24:22</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/black-devops-guidebook/umi.js"></script>
    <script src="/black-devops-guidebook/docs__linux__command__system.md.js"></script>
  </body>
</html>
